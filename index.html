<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<title>Earthquakes JP</title>

<!-- ========================
     STYLE VISUEL (CSS)
========================= -->
<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f1115;
  color:white;
}

/* layout gauche = carte / droite = liste */
.app{
  display:flex;
  height:100vh;
}

.left{
  flex:3;
  padding:15px;
  border-right:1px solid #333;
}

.right{
  flex:2;
  overflow:auto;
  padding:15px;
}

/* card séisme */
.item{
  border:1px solid #333;
  padding:10px;
  margin-bottom:10px;
  border-radius:10px;
  cursor:pointer;
}

.item.selected{
  border-color:#7aa2ff;
}
</style>
</head>

<body>

<!-- ========================
     STRUCTURE HTML
========================= -->
<div class="app">

  <!-- ZONE CARTE (pour plus tard) -->
  <div class="left">
    <h2>Carte (bientôt)</h2>
    <div id="selected">Chargement…</div>
  </div>

  <!-- LISTE DES SÉISMES -->
  <div class="right">
    <h2>30 derniers séismes</h2>
    <div id="list"></div>
  </div>

</div>

<!-- ========================
     SCRIPT JAVASCRIPT
========================= -->
<script>

// variable globale = séisme sélectionné
let selectedId = null;

/*
  Fonction principale:
  - charge events.json
  - affiche la liste
*/
async function main(){

  // charger le fichier généré par ton scraper
  const res = await fetch("./events.json");
  const data = await res.json();

  const events = data.events || [];
  const listEl = document.getElementById("list");

  // si aucun événement
  if(events.length === 0){
    listEl.innerHTML = "Aucun séisme.";
    return;
  }

  // sélection par défaut = premier
  if(!selectedId) selectedId = events[0].id;

  // vider la liste
  listEl.innerHTML = "";

  // créer une card par séisme
  events.forEach(ev => {

    const div = document.createElement("div");
    div.className = "item" + (ev.id===selectedId ? " selected" : "");

    div.innerHTML =
      "<b>M " + (ev.magnitude ?? "?") + "</b> | " +
      "Max " + (ev.maxIntensity || "?") +
      "<br>" +
      (ev.region || ev.title || "-");

    // quand on clique
    div.onclick = () => {
      selectedId = ev.id;

      // afficher le séisme sélectionné
      document.getElementById("selected").textContent =
        "Séisme sélectionné: " + (ev.region || ev.title) +
        "<br><span style='font-size:12px;color:#aaa'>" +
        ev.detailUrl +
        "</span>";
         
      // re-dessiner la liste
      main();
    };

    listEl.appendChild(div);
  });
}

// lancer le script
main();

</script>
</body>
</html>
